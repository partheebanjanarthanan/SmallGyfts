<!DOCTYPE html>
<html>

  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="icon" href="img/apple-touch-icon-152x152.png" />
    <link rel="apple-touch-icon" href="img/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-startup-image" href="splash.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />


    <title>SmallGyfts&#0153;</title>

	
	<link href="css/style.css" rel="stylesheet" type="text/css" />

  </head>

  <body>

	<iframe id="t2s" class="t2sf" name="t2sframe" src="https://www.smallgyfts.com/default_bs.asp"
	 frameBorder="0"
     margin-top="20"
	 margin-botton="0"
	 marginwidth="0"
	 marginheight="0">
	</iframe>
    

    <img onclick="scan();" src="img/bluecamera.png" border="0" alt="scan" id="scanbutton" height="57" style="position:fixed; right:17px; top:2px; z-index: 2; opacity: 1.0;" />



	<script type="text/javascript" charset="utf-8">
		var iframeT2S = document.getElementById('t2s');
		var sHome = 'https://www.smallgyfts.com/default_bs.asp#_Home';


		//add "device ready"listener
		document.addEventListener('deviceready', onDeviceReady, false);
        
    
    // device APIs are available
    //
    function onDeviceReady() {
        
        document.addEventListener('pause', pause, false);
    }
    
    // Handle the pause event
    //
    // function pause (argument) {
    //    if (typeof document.app.player != 'undefined') {
    //        document.app.player.pauseVideo();
    //    }
    //}
    function pause () {
    //    alert('smallgyfts = '+document.getElementById("t2s").src.substring(26,37));
    //    iframeT2S.contentWindow.location.href = 'http://www.smallgyfts.com';
        if(scanbutton.height!="43"){
            if(document.getElementById("t2s").src.substring(26,37)=="tagresponse"||document.getElementById("t2s").src.substring(23,34)=="tagresponse"||document.getElementById("t2s").src.substring(31,42)=="tagresponse"){
            
                iframeT2S.contentWindow.location.href = document.getElementById("t2s").src;
                scanbutton.height="43";

            }
        }else{
            iframeT2S.contentWindow.history.back();
        }
    }

		function scan(){
			cordova.plugins.barcodeScanner.scan(
      				function (result) {
                    if(result.text.substring(0,25)=="http://www.smallgyfts.com"||result.text.substring(0,22)=="http://www.try2see.com"){
                        //window.location.assign(result.text);
                        document.getElementById("t2s").src = result.text;
                    }else{
                        if(result.text.substring(0,4)=="http"){
                            var ref=window.open(result.text, '_blank', 'location=yes');
                        }else{
                        var ref=window.open('http://'+result.text, '_blank', 'location=yes');
                        //return true;
                        }
                                    }
                    //scanbutton.height="43";
					//parseResult(result.text, result.format, result.canceled);
          			}, 
      				function (error) {
         				alertParseError(error);	
     				}	
   			);
		}

		function backHandler(){


			//if home, exit app
			if(iframeT2S.contentWindow.location.href == sHome){
			//do nothing	navigator.app.exitApp();
                //navigator.app.backHistory();
                iframeT2S.contentWindow.history.back();


			}else{
			
				//navigate back one page
				//navigator.app.backHistory();
                iframeT2S.contentWindow.history.back();
			}

		

		}

	</script>

</body>


</html>